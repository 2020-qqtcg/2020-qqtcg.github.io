<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>计算机网络（应用层） | 划水摸鱼</title><meta name="keywords" content="计网,笔记"><meta name="author" content="jianjian"><meta name="copyright" content="jianjian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="网络应用的体系结构客户机&#x2F;服务器结构（C&#x2F;S）  服务器 永久性访问地址&#x2F;域名 不间断提供服务 利用大量服务器实现可扩展性   客户机 与服务器通信，使用服务器提供的功能 间歇性接入网络 可以使用动态IP 不会与其它客户机直接交互     点对点结构（P2P）  没有永久在线的服务器 任意端系统之间可以直接通讯 间歇性接入网络 节点可能改变IP地址  优点：高度可伸缩 缺点：难于管理 混合结构（H">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络（应用层）">
<meta property="og:url" content="https://mujian.work/2022/05/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%89/index.html">
<meta property="og:site_name" content="划水摸鱼">
<meta property="og:description" content="网络应用的体系结构客户机&#x2F;服务器结构（C&#x2F;S）  服务器 永久性访问地址&#x2F;域名 不间断提供服务 利用大量服务器实现可扩展性   客户机 与服务器通信，使用服务器提供的功能 间歇性接入网络 可以使用动态IP 不会与其它客户机直接交互     点对点结构（P2P）  没有永久在线的服务器 任意端系统之间可以直接通讯 间歇性接入网络 节点可能改变IP地址  优点：高度可伸缩 缺点：难于管理 混合结构（H">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/05/07/qf4e2z9YBmPhV3c.png">
<meta property="article:published_time" content="2022-05-07T02:43:28.000Z">
<meta property="article:modified_time" content="2022-05-15T08:36:03.397Z">
<meta property="article:author" content="jianjian">
<meta property="article:tag" content="计网">
<meta property="article:tag" content="笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/05/07/qf4e2z9YBmPhV3c.png"><link rel="shortcut icon" href="https://s2.loli.net/2022/04/19/pm7NeZBgDW3VJIP.png"><link rel="canonical" href="https://mujian.work/2022/05/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%89/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":600},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机网络（应用层）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-15 16:36:03'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2022/04/19/dkPLexUuNBIclp4.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2022/05/07/qf4e2z9YBmPhV3c.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">划水摸鱼</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计算机网络（应用层）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-05-07T02:43:28.000Z" title="发表于 2022-05-07 10:43:28">2022-05-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-05-15T08:36:03.397Z" title="更新于 2022-05-15 16:36:03">2022-05-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%BD%91/">计网</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计算机网络（应用层）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="网络应用的体系结构"><a href="#网络应用的体系结构" class="headerlink" title="网络应用的体系结构"></a>网络应用的体系结构</h1><h2 id="客户机-服务器结构（C-S）"><a href="#客户机-服务器结构（C-S）" class="headerlink" title="客户机/服务器结构（C/S）"></a>客户机/服务器结构（C/S）</h2><p><img src="https://s2.loli.net/2022/05/07/ThumBVCXE1Nxozk.png" alt="image-20220507105233916"></p>
<ul>
<li>服务器<ul>
<li>永久性访问地址/域名</li>
<li>不间断提供服务</li>
<li>利用大量服务器实现可扩展性</li>
</ul>
</li>
<li>客户机<ul>
<li>与服务器通信，使用服务器提供的功能</li>
<li>间歇性接入网络</li>
<li>可以使用动态IP</li>
<li>不会与其它客户机直接交互</li>
</ul>
</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/07/qf4e2z9YBmPhV3c.png" alt="image-20220507105443390"></p>
<h2 id="点对点结构（P2P）"><a href="#点对点结构（P2P）" class="headerlink" title="点对点结构（P2P）"></a>点对点结构（P2P）</h2><p><img src="https://s2.loli.net/2022/05/07/9HDPihQgjMa56B7.png" alt="image-20220507105507846"></p>
<ul>
<li>没有永久在线的服务器</li>
<li>任意端系统之间可以直接通讯</li>
<li>间歇性接入网络</li>
<li>节点可能改变IP地址</li>
</ul>
<p><strong>优点</strong>：高度可伸缩</p>
<p><strong>缺点</strong>：难于管理</p>
<h2 id="混合结构（Hybird）"><a href="#混合结构（Hybird）" class="headerlink" title="混合结构（Hybird）"></a>混合结构（Hybird）</h2><p><strong>Napster</strong></p>
<p><img src="https://s2.loli.net/2022/05/07/5c3alQUbmxXYOu7.png" alt="image-20220507105907224"></p>
<ul>
<li>文件传输用P2P结构</li>
<li>文件搜索采用C/S结构——集中式</li>
</ul>
<h1 id="网络应用进程通信"><a href="#网络应用进程通信" class="headerlink" title="网络应用进程通信"></a>网络应用进程通信</h1><h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><p>同一主机上运行的进程之间：</p>
<ul>
<li>进程舰通信机制</li>
<li>操作系统提供</li>
</ul>
<p>不同主机上运行的进程舰通信：</p>
<ul>
<li>消息交换</li>
</ul>
<p><strong>客户机进程</strong>：发起通信的进程</p>
<p><strong>服务器进程</strong>：等待通信请求的进程</p>
<h2 id="套接字"><a href="#套接字" class="headerlink" title="套接字"></a>套接字</h2><p><img src="https://s2.loli.net/2022/05/07/1q3gVKGXOklRxnL.png" alt="image-20220507111130591"></p>
<ul>
<li>进程间利用socket发送/接收消息</li>
<li>socket是传输基础设施向进程提供的API</li>
</ul>
<h2 id="如何寻址"><a href="#如何寻址" class="headerlink" title="如何寻址"></a>如何寻址</h2><p>不同主机上的进程舰通信，每个进程都必须有标识符</p>
<p>我们通过IP地址寻址主机，但同一主机上可能同时有多个进程需要通信，需要为主机上每个需要通信的进程分配一个端口号，通过<strong>IP地址+端口号作为进程的标识</strong></p>
<h1 id="域名解析系统DNS"><a href="#域名解析系统DNS" class="headerlink" title="域名解析系统DNS"></a>域名解析系统DNS</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Domain Name System</p>
<ul>
<li>多层命名服务器构成的分布式数据库</li>
<li>应用层协议：完成名字的解析<ul>
<li>提供Internet核心功能，用应用层协议实现</li>
<li>网络边界复杂</li>
</ul>
</li>
</ul>
<p>解决Internet上主机/路由器的识别问题：互联网中的主机以IP地址为唯一标识符，IP本身是数字，不利于人使用，日常使用的是域名。DNS能够将域名解析为IP地址</p>
<p>DNS服务</p>
<ul>
<li>域名向IP地址的翻译</li>
<li>主机别名</li>
<li>邮件服务器别名</li>
<li>负载均衡：Web服务器</li>
</ul>
<blockquote>
<p>负载均衡就是分摊到多个操作单元上进行执行</p>
<p>为什么不采用集中式的DNS</p>
<ul>
<li>单点失败问题，如果采用集中式而DNS出现问题会使整个网络瘫痪</li>
<li>流量问题</li>
<li>距离问题</li>
<li>维护性问题</li>
</ul>
</blockquote>
<p>DNS采用分布式层次式数据库</p>
<p><img src="https://s2.loli.net/2022/05/07/cQZD4ISmyqfbTdr.png" alt="image-20220507191147912"></p>
<blockquote>
<p>客户端想要查询www.amazon.com的IP</p>
<ul>
<li>客户端查询根服务器，找到com域名解析服务器</li>
<li>客户端查询con域名解析服务器，找到amazon.com域名解析服务器</li>
<li>客户端查询amazon.com域名解析服务器，获得www.amazon.com的IP地址</li>
</ul>
</blockquote>
<h2 id="DNS域名服务器"><a href="#DNS域名服务器" class="headerlink" title="DNS域名服务器"></a>DNS域名服务器</h2><p><strong>根域名服务器</strong></p>
<p>本地域名服务器无法解析域名时，访问根域名服务器，如果根域名服务器不知道映射，访问权威域名服务器获得映射，向本地域名服务器返回映射</p>
<p><img src="https://s2.loli.net/2022/05/07/mwr5A1KavjBXz9L.png" alt="image-20220507191708761"></p>
<p><strong>顶级域名服务器（TLD）</strong>负责com，org，net，edu等顶级域名和国家级域名，例如cn，uk，fr等</p>
<ul>
<li>由一些公司来维护</li>
</ul>
<p><strong>权威域名服务器</strong>：组织的域名解析服务器，提供组织内部服务器的解析服务</p>
<ul>
<li>组织负责维护</li>
<li>服务提供商负责维护</li>
</ul>
<p><strong>本地域名解析服务器</strong></p>
<ul>
<li>不严格属于层次体系</li>
<li>每个ISP有一个本地域名服务器（默认域名解析服务器）</li>
<li>当主机进行DNS查询时，查询被发送到本地域名服务器，作为代理将查询转发给（层级式）域名解析服务器系统</li>
</ul>
<blockquote>
<p>迭代查询：</p>
<p><img src="https://s2.loli.net/2022/05/07/GighvxQN7Ultad3.png" alt="image-20220507192605961"></p>
<p>递归查询：</p>
<p><img src="https://s2.loli.net/2022/05/07/qJ9Z5GQcX8ShxjV.png" alt="image-20220507192654729"></p>
</blockquote>
<p><strong>DNS记录缓存和更新</strong></p>
<p>只要域名解析服务器获得域名—IP映射，即缓存这一映射，一段时间过后缓存条目失效（删除），本地域名服务器一般会缓存顶级域名服务器的映射，因此根域名服务器不经常被访问</p>
<h2 id="DNS记录和消息格式"><a href="#DNS记录和消息格式" class="headerlink" title="DNS记录和消息格式"></a>DNS记录和消息格式</h2><h3 id="记录"><a href="#记录" class="headerlink" title="记录"></a>记录</h3><p>资源记录（resource records）</p>
<p><img src="https://s2.loli.net/2022/05/07/F8z921StkicOIEg.png" alt="image-20220507193239691"></p>
<ul>
<li>Type=A<ul>
<li>name：主机域名</li>
<li>value：IP地址</li>
</ul>
</li>
<li>Type=NS<ul>
<li>name：域</li>
<li>value：该域权威域名解析服务器的主机域名</li>
</ul>
</li>
<li>Type=CNAME<ul>
<li>name：某一真是域名的别名</li>
<li>value：真实域名</li>
</ul>
</li>
<li>Type=MX<ul>
<li>value是与name相对应的邮件服务器</li>
</ul>
</li>
</ul>
<h3 id="消息格式"><a href="#消息格式" class="headerlink" title="消息格式"></a>消息格式</h3><p>DNS协议是查询和恢复协议，消息格式相同</p>
<p><img src="https://s2.loli.net/2022/05/07/DEaf5ych9kUnKJX.png" alt="image-20220507193859644"></p>
<ul>
<li>identification：16位查询编号，回复使用相同的编号</li>
<li>flags<ul>
<li>查询或恢复</li>
<li>期望递归</li>
<li>递归可用</li>
<li>权威回答</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>DNS占用53号端口，同时使用TCP和UDP协议。**</strong>DNS区域传输的时候使用TCP协议<strong>：辅域名服务器会定时（一般3小时）向主域名服务器进行查询以便了解数据是否有变动。如有变动，会执行一次区域传送，进行数据同步。区域传送使用TCP而不是UDP，因为数据同步传送的数据量比一个请求应答的数据量要多得多。</strong>域名解析时使用UDP协议**：客户端向DNS服务器查询域名，一般返回的内容都不超过512字节，用UDP传输即可。不用经过三次握手，这样DNS服务器负载更低，响应更快。理论上说，客户端也可以指定向DNS服务器查询时用TCP，但事实上，很多DNS服务器进行配置的时候，仅支持UDP查询包。</p>
<p>如何注册域名</p>
<p><img src="https://s2.loli.net/2022/05/07/YdNIm4LsbhagFVz.png" alt="image-20220507194507756"></p>
</blockquote>
<h1 id="应用层协议概述"><a href="#应用层协议概述" class="headerlink" title="应用层协议概述"></a>应用层协议概述</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li><p>公开的协议</p>
<ul>
<li><p>由RFC定义</p>
</li>
<li><p>允许互相操作</p>
</li>
<li>HTTP，SMTP ······</li>
</ul>
</li>
<li><p>私有的协议</p>
<ul>
<li>多数P2P文件共享应用</li>
</ul>
</li>
</ul>
<h3 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h3><ul>
<li><p>消息的类型</p>
<ul>
<li>请求消息</li>
<li>响应消息</li>
</ul>
</li>
<li><p>语法格式</p>
<p><img src="https://s2.loli.net/2022/05/07/QjqtIP6VDGFJSY1.png" alt="image-20220507112053439"></p>
</li>
<li><p>语义</p>
</li>
<li><p>规则</p>
</li>
</ul>
<h3 id="对传输层服务的需求"><a href="#对传输层服务的需求" class="headerlink" title="对传输层服务的需求"></a>对传输层服务的需求</h3><ul>
<li><p>数据丢失/可靠性</p>
</li>
<li><p>时间/延迟</p>
</li>
<li>带宽</li>
</ul>
<h4 id="Internet提供的传输服务"><a href="#Internet提供的传输服务" class="headerlink" title="Internet提供的传输服务"></a>Internet提供的传输服务</h4><ul>
<li>TCP服务<ul>
<li>面向连接</li>
<li>可靠传输</li>
<li>流量控制</li>
<li>拥塞控制</li>
<li>不提供时延服务、最小带宽保障</li>
</ul>
</li>
<li>UDP服务<ul>
<li>无连接</li>
<li>不可靠数据传输</li>
</ul>
</li>
</ul>
<h1 id="文件传送协议"><a href="#文件传送协议" class="headerlink" title="文件传送协议"></a>文件传送协议</h1><blockquote>
<p>FTP与TFTP都是<strong>复制整个文件</strong>类的协议，即若要存取一个文件，就必须先获得一个本地的文件副本。如果要修改文件，只能对文件的副本进行修改，然后再将修改后的文件副本传回到原节点。另一大类是<strong>联机访问</strong>，联机访问意味着允许多个程序同时对一个文件进行存取。和数据库系统的不同之处是用户不需要调用一个特殊的客户进程，而是由操作系统提供对远地共享文件进行访问的服务，就如同对本地文件的访问一样。这就使用户可以用远地文件作为输入和输出来运行任何应用程序，而操作系统中的文件系统则提供对共享文件的透明存取。</p>
</blockquote>
<h2 id="FTP协议"><a href="#FTP协议" class="headerlink" title="FTP协议"></a>FTP协议</h2><p>FTP基于TCP，主要功能是减少或消除在不同操作系统下的处理文件的不兼容性</p>
<p>FTP使用C/S，一个FTP服务器可同时为多个客户进程提供服务。FTP<br>的服务器进程由两大部分组成：一个<strong>主进程</strong>，负责接受新的请求；另外有若干个<strong>从属进程</strong>，负责处理单个请求。</p>
<p><strong>主进程的工作步骤</strong>：</p>
<ul>
<li>打开端口21，使客户进程能够连接上</li>
<li>等待客户进程发出连接请求</li>
<li>启动从属进程处理客户进程发来的请求。从属进程对客户进程的请求处理完毕后即终止，但从属进程在运行期间根据需要还可能创建其他一些子进程</li>
<li>回到等待状态，继续接受其他客户进程发来的请求。主进程与从属进程的处理是并发进行的</li>
</ul>
<p>当客户进程向服务器进程发出建立连接请求时，要寻找连接服务器进程的熟知端口21,同时还要告诉服务器进程自己的另一个端口号码，用于建立数据传送连接。接着，服务器进程用自己传送数据的熟知端口20 与客户进程所提供的端口号建立数据传送连接</p>
<p><img src="https://s2.loli.net/2022/05/08/hxfF7JsTcQRiZ6O.png" alt="image-20220508094838923"></p>
<p>（为了简单起见，主进程没有画）</p>
<p>在进行文件传输时， FTP 的客户和服务器之间要建立两个并行的TCP 连接：“控制连接”和“数据连接＂。控制连接在整个会话期间一直保持打开， FTP 客户所发出的传送请求，通过控制连接发送给服务器端的控制进程，但控制连接并不用来传送文件。实际用千传<br>输文件的是“数据连接＂。服务器端的控制进程在接收到FTP 客户发送来的文件传输请求后就创建“数据传送进程”和“数据连接”，用来连接客户端和服务器端的数据传送进程。数据传送进程实际完成文件的传送，在传送完毕后关闭“数据传送连接”并结束运行。由于FTP 使用了一个分离的控制连接，因此FTP 的控制信息是带外(out of band)传送的</p>
<h2 id="TFTP协议"><a href="#TFTP协议" class="headerlink" title="TFTP协议"></a>TFTP协议</h2><p>TFTP也使用C/S模式，使用UDP。因此TFTP 需要有自己的差错改<br>正措施。TFTP 只支持文件传输而不支持交互。TFTP 没有一个庞大的命令集，没有列目录的功能，也不能对用户进行身份鉴别。</p>
<p>特点：</p>
<ol>
<li>每次传送的数据报文中有512 字节的数据，但最后一次可不足512 字节。</li>
<li>数据报文按序编号，从1 开始。</li>
<li>支持ASCII 码或二进制传送。</li>
<li>可对文件进行读或写。</li>
<li>使用很简单的首部。</li>
</ol>
<p>发送完一个文件块后就等待对方的确认，确认时应指明所确认的块编号。发完数据后在规定时间内收不到确认就要重发数据PDU 。发送确认PDU 的一方若在规定时间内收不到下一个文件块，也要重发确认PDU 。这样就可保证文件的传送不致因某一个数据报的丢失而告失败。<br>在一开始工作时。TFTP 客户进程发送一个读请求报文或写请求报文给TFTP 服务器进程，其熟知端口号码为69 。TFTP 服务器进程要选择一个新的端口和TFTP 客户进程进行通信。若文件长度恰好为512 字节的整数倍，则在文件传送完毕后，还必须在最后发送一个只<br>含首部而无数据的数据报文。若文件长度不是512 字节的整数倍，则最后传送数据报文中的数据字段一定不满512 字节，这正好可作为文件结束的标志。</p>
<h2 id="TELNET协议"><a href="#TELNET协议" class="headerlink" title="TELNET协议"></a>TELNET协议</h2><p>TELNET 也使用C/S方式。在本地系统运行TELNET 客户进程，而在远地主机则运行TELNET 服务器进程。</p>
<p><img src="https://s2.loli.net/2022/05/08/TOZXiHhMALDb6lE.png" alt="image-20220508134152954"></p>
<h1 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h1><p>HyperText Transfer Protocol</p>
<p><img src="https://s2.loli.net/2022/05/07/ZWbNYwStPrlDgOz.png" alt="image-20220507143453997"></p>
<p><img src="https://s2.loli.net/2022/05/07/uVjILEJZ3xh25sy.png" alt="image-20220507134947093"></p>
<p>C/S结构</p>
<ul>
<li>客户—Browser：请求、接收、展示Web对象</li>
<li>服务器—Web Server：响应客户的请求，发送对象</li>
</ul>
<p><strong>使用TCP传输服务</strong></p>
<ul>
<li>服务器在80端口等待客户的请求</li>
<li>浏览器发起到服务器的TCP连接（创建套接字Socket）</li>
<li>服务器接受来自浏览器的TCP连接</li>
<li>浏览器与Web服务器交换HTTP消息</li>
<li>关闭TCP连接</li>
</ul>
<p><strong>无状态</strong></p>
<ul>
<li>服务器不维护任何有关客户端过去所发送的请求的信息</li>
</ul>
<blockquote>
<p>有状态的协议更复杂：</p>
<ul>
<li>需要维护状态</li>
<li>如果客户或服务器失效，会产生状态不一致，解决这种不一致代价高</li>
</ul>
</blockquote>
<h2 id="HTTP连接的两种类型"><a href="#HTTP连接的两种类型" class="headerlink" title="HTTP连接的两种类型"></a>HTTP连接的两种类型</h2><h3 id="非持久性连接（Nonpersistent-HTTP）"><a href="#非持久性连接（Nonpersistent-HTTP）" class="headerlink" title="非持久性连接（Nonpersistent HTTP）"></a>非持久性连接（Nonpersistent HTTP）</h3><p>HTTP/1.0使用</p>
<ul>
<li>每个TCP连接最多允许传输一个对象</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/07/YEV53t9JcHDwueo.png" alt="image-20220507140814248"></p>
<p><img src="https://s2.loli.net/2022/05/07/e1EqBT3bNQrYIig.png" alt="image-20220507140931139"></p>
<blockquote>
<p>RTT（Round Trip Time）</p>
<p>从客户端发送一个很小的数据包到服务器并返回所经历的时间</p>
</blockquote>
<p><img src="https://s2.loli.net/2022/05/07/9ZFzxQvJOcDP5Vr.png" alt="image-20220507141600192"></p>
<p>简单分析响应时间：发送、建立TCP连接需要1个RTT，发送HTTP请求消息到HTTP响应消息的前几个字节到达需要1个RTT，还要加上响应消息中所含的文件传输时间</p>
<p>$Total = 2RTT + 文件发送时间$</p>
<p>非持久性连接每个对象需要2个RTT，操作系统需要为每个TCP连接开销资源（ooverhead），假如浏览器为提高效率打开多个并行的TCP连接以获取网页所需对象，又会给服务器带来很大的负担</p>
<h3 id="持久性连接（Persistent-HTTP）"><a href="#持久性连接（Persistent-HTTP）" class="headerlink" title="持久性连接（Persistent HTTP）"></a>持久性连接（Persistent HTTP）</h3><p>HTTP/1.1使用（带有流水机制的持久性连接）</p>
<ul>
<li>每个TCP连接允许传输多个对象</li>
<li>发送响应后，服务器保持TCP连接的打开，后续的HTTP消息可以通过这个连接发送</li>
</ul>
<p><strong>无流水的持久性连接</strong></p>
<ul>
<li>客户端只有收到前一个响应后才发送新的请求</li>
<li>每个被引用的对象耗时1个RTT</li>
</ul>
<p><strong>带有流水机制的持久性连接</strong></p>
<ul>
<li>客户端只要遇到一个应用对象就尽快发出请求</li>
<li>理想情况下，收到所有的应用对象只需要耗时约1个RTT</li>
</ul>
<h2 id="HTTP消息"><a href="#HTTP消息" class="headerlink" title="HTTP消息"></a>HTTP消息</h2><h3 id="请求消息"><a href="#请求消息" class="headerlink" title="请求消息"></a>请求消息</h3><p><img src="https://s2.loli.net/2022/05/07/JYwy5qoFNGHXung.png" alt="image-20220507143751524"></p>
<p><strong>通用格式</strong></p>
<p><img src="https://s2.loli.net/2022/05/07/5aqzltdQmEePUMT.png" alt="image-20220507143857782"></p>
<blockquote>
<p>上传输入的方法：</p>
<p>POST方法：在Entity Body中上传客户端的输入</p>
<p>URL方法：使用GET方法在request行的URL字段中上传，<code>https://www.bilibili.com/video/BV1Up411Z7hC?p=23&amp;spm_id_from=pageDriver</code>中？后面的部分，以键值对的形式传输<code>name=value</code></p>
<p>HTTP/1.0方法类型：</p>
<ul>
<li>GET</li>
<li>POST</li>
<li>HEAD：请Server不要将所请求的对象放入响应消息中</li>
</ul>
<p>HTTP/1.1：</p>
<ul>
<li>GET、POST、HEAD</li>
<li>PUT：将消息体中的文件上川岛URL字段所指定的路径</li>
<li>DELETE：删除URL字段所指定的文件</li>
</ul>
</blockquote>
<h3 id="响应消息"><a href="#响应消息" class="headerlink" title="响应消息"></a>响应消息</h3><p><img src="https://s2.loli.net/2022/05/07/fKIZN4FYQcTEHWn.png" alt="image-20220507144734691"></p>
<p>Date：Web服务器生成消息的时间</p>
<p><strong>状态：</strong></p>
<ul>
<li>1xx 表示通知信息，如请求收到了或正在进行处理。</li>
<li>2xx 表示成功，如接受或知道了。</li>
<li>3xx 表示重定向，如要完成请求还必须采取进一步的行动。</li>
<li>4xx 表示客户的差错，如请求中有错误的语法或不能完成。</li>
<li>5xx 表示服务器的差错，如服务器失效无法完成请求。</li>
</ul>
<h2 id="Cookie技术"><a href="#Cookie技术" class="headerlink" title="Cookie技术"></a>Cookie技术</h2><p>HTTP协议是无状态协议，但在许多情况下需要服务器掌握客户端的状态，需要引入Cookie技术</p>
<p>Cookie技术是某些网站为了辨别用户身份、进行session跟踪而储存在用户本地终端上的数据</p>
<p>Cookie组件</p>
<ul>
<li>HTTP响应消息的cookie头部行</li>
<li>HTTP请求消息的cookie头部行</li>
<li>保存在客户端主机上的cookie文件，由浏览器管理</li>
<li>Web服务器端的后台数据库</li>
</ul>
<p>原理：</p>
<p><img src="https://s2.loli.net/2022/05/07/FywTYLqBZ5WaUPh.png" alt="image-20220507150421459"></p>
<p>作用：</p>
<ul>
<li>身份认证</li>
<li>购物车</li>
<li>推荐</li>
<li>Web e-mail</li>
</ul>
<p>Cookie技术存在隐私问题</p>
<h2 id="Web缓存-代理服务器技术"><a href="#Web缓存-代理服务器技术" class="headerlink" title="Web缓存/代理服务器技术"></a>Web缓存/代理服务器技术</h2><p>在不访问服务器的前提下满足客户端的HTTP请求</p>
<p>优势：</p>
<ul>
<li>缩短客户请求的响应时间</li>
<li>减少机构/组织的流量</li>
<li>在大范围内实现有效的内容分发（CDN）</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/07/sjV9FQIA5kd6oY8.png" alt="image-20220507152121546"></p>
<p>用户设定浏览器通过缓存进行Web访问，浏览器向缓存/代理服务器发送所有的HTTP请求，如果所请求的对象在缓存中，缓存返回对象；否则，缓存服务器向原始服务器发送HTTP请求，获取对象，然后返回给客户端保存该对象。</p>
<p>缓存既充当客户端，也充当服务器，一般由ISP假设</p>
<blockquote>
<p><strong>示例：</strong></p>
<p><img src="https://s2.loli.net/2022/05/07/qcO6Jmw2kYiG1Rt.png" alt="image-20220507154325337"></p>
<p>互联网链路利用率过高</p>
<p>解决方案1：提高互联网接入宽带=10Mbps，但成本过高</p>
<p>解决方案2：（设计思想与cache类似）</p>
<p><img src="https://s2.loli.net/2022/05/07/tXkZbN18OMTrED4.png" alt="image-20220507154630696"></p>
</blockquote>
<p>使用<strong>条件性GET方法</strong>来确保缓存/代理服务器中保存的是最新的信息，在HTTP请求消息中声明所持有版本的日期（<code>If-modified-since:&lt;date&gt;</code>），如果缓存的版本是最新的，则响应消息中不包含对象（<code>HTTP/1.0 304 Not Modified</code>），此时只有一个空的响应，占用的带宽是很小的</p>
<p><img src="https://s2.loli.net/2022/05/07/w81p6bCvIWdBeht.png" alt="image-20220507155207945"></p>
<h1 id="Email应用"><a href="#Email应用" class="headerlink" title="Email应用"></a>Email应用</h1><h2 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h2><p>构成组件</p>
<ul>
<li>邮件客户端<ul>
<li>读、写Email消息</li>
<li>与服务器交互，收，发消息</li>
<li>Web客户端</li>
</ul>
</li>
<li>邮件服务器（核心）</li>
<li>SMTP协议（Simple Mail Transfer Protocol）</li>
</ul>
<p><strong>邮件服务器</strong></p>
<ul>
<li>邮箱：存储发给该用户的Email</li>
<li>消息队列：存储等待发送的Email</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/07/ZXFouN3KRAmYBpk.png" alt="image-20220507160906524"></p>
<blockquote>
<p>为什么要邮件服务器？</p>
<ul>
<li>客户端不能时时刻刻在线</li>
</ul>
</blockquote>
<p>Email是一个典型的<strong>异步</strong>应用</p>
<p><img src="https://s2.loli.net/2022/05/07/Gn2i38QpDhfczSM.png" alt="image-20220507161604505"></p>
<h2 id="SMTP协议"><a href="#SMTP协议" class="headerlink" title="SMTP协议"></a>SMTP协议</h2><ul>
<li>使用TCP进行可靠传输</li>
<li><p>端口25</p>
</li>
<li><p>命令/响应交互模式</p>
</li>
<li>Email消息只能包含7位ASCII码</li>
</ul>
<p>SMTP交互示例：</p>
<p><img src="https://s2.loli.net/2022/05/07/F53m1wQCWXgkjpG.png" alt="image-20220507161925241"></p>
<p>SMTP使用持久性连接，要求消息必须由7位ASCII码构成，SMTP服务器利用CRLF.CRLF确定消息的结束。</p>
<blockquote>
<p>与HTTP相比，HTTP是拉式（pull），SMTP是退式（push）；二者都使用命令/响应交互模式；命令和状态代码都是ASCII码；HTTP每个对象封装在独立的响应消息中，SMTP多个对象在由多个部分构成的消息中发送</p>
</blockquote>
<h2 id="Email消息格式"><a href="#Email消息格式" class="headerlink" title="Email消息格式"></a>Email消息格式</h2><p><img src="https://s2.loli.net/2022/05/07/Wd4jDSlrBoKMJXh.png" alt="image-20220507162612725"></p>
<p>header：</p>
<ul>
<li>To</li>
<li>From</li>
<li>Subject</li>
</ul>
<p>body：</p>
<ul>
<li>消息本身</li>
<li>只能是ASCII字符</li>
</ul>
<p><strong>MIME：多媒体邮件扩展</strong></p>
<p>通过在邮件头部增加额外的行以声明MIME的内容类型</p>
<p><img src="https://s2.loli.net/2022/05/07/BSfrRKz3vZ1AjbY.png" alt="image-20220507162950994"></p>
<h2 id="邮件访问（读取）协议"><a href="#邮件访问（读取）协议" class="headerlink" title="邮件访问（读取）协议"></a>邮件访问（读取）协议</h2><p><img src="https://s2.loli.net/2022/05/07/i8J3ZVLPtYx7qI2.png" alt="image-20220507164228808"></p>
<p>邮件访问协议：从服务器获取邮件</p>
<ul>
<li>POP（邮局协议）：Post Office Protocol<ul>
<li>认证/授权（客户端&lt;—&gt;服务器）和下载</li>
</ul>
</li>
<li>IMAP：Internet Mail Access Protocol<ul>
<li>更多功能</li>
<li>更加复杂</li>
<li>能够操纵服务器上的储存消息</li>
</ul>
</li>
<li>HTTP：163，QQMail等</li>
</ul>
<h3 id="POP3协议"><a href="#POP3协议" class="headerlink" title="POP3协议"></a>POP3协议</h3><p><img src="https://s2.loli.net/2022/05/07/2jufUFZHiGWabc6.png" alt="image-20220507165222253"></p>
<p><strong>认证过程</strong></p>
<ul>
<li>客户端命令<ul>
<li>User</li>
<li>Pass：声明密码</li>
</ul>
</li>
<li>服务器响应<ul>
<li>+OK</li>
<li>-ERR</li>
</ul>
</li>
</ul>
<p><strong>事务阶段</strong></p>
<ul>
<li>List：列出消息数量</li>
<li>Retr：用编号获取消息</li>
<li>Dele：删除消息</li>
<li>Quit</li>
</ul>
<p>“下载并删除”模式：用户如果换了客户端软件，无法重读该邮件</p>
<p>“下载并保持”模式：不同客户端都可以保留消息的拷贝</p>
<p>POP3是无状态的</p>
<h3 id="IMAP协议"><a href="#IMAP协议" class="headerlink" title="IMAP协议"></a>IMAP协议</h3><p>所有消息统一保存在服务器上，允许用户利用文件夹组织消息</p>
<p>支持跨会话（Session）的用户状态</p>
<ul>
<li>文件夹的名字</li>
<li>文件夹与消息ID之间的映射</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/07/Xo8qpBGveah9SzL.png" alt="image-20220507170157532"></p>
<h1 id="P2P应用"><a href="#P2P应用" class="headerlink" title="P2P应用"></a>P2P应用</h1><blockquote>
<p>文件分发：C/S 与 P2P<br><img src="C:\Users\MJ\AppData\Roaming\Typora\typora-user-images\image-20220507195101883.png" alt="image-20220507195101883"></p>
<p>C/S:</p>
<p><img src="https://s2.loli.net/2022/05/07/oual2ciIhTRSNCj.png" alt="image-20220507195346944"></p>
<p>P2P:</p>
<p><img src="https://s2.loli.net/2022/05/07/ojrBAkhDUnbRZtG.png" alt="image-20220507195450452"></p>
<p><img src="https://s2.loli.net/2022/05/07/rVNzZLHYTglPp2s.png" alt="image-20220507195942280"></p>
</blockquote>
<h2 id="BitTorrent"><a href="#BitTorrent" class="headerlink" title="BitTorrent"></a>BitTorrent</h2><p><img src="https://s2.loli.net/2022/05/07/xeTJtHhjUIZNfR2.png" alt="image-20220507200949912"></p>
<p>文件划分为256KB的chunk，节点加入torrent，一开始没有chunk，但会逐渐积累，向tracker注册以获得节点清单，与厚些节点（“邻居”）建立连接。下载的同时，节点需要向其它节点上传chunk，节点可能加入或离开，一旦节点获得完整的文件，它可能（自私地）离开或（无私地）留下</p>
<p><strong>获取chunk</strong></p>
<ul>
<li>给定任一时刻，不同的节点持有文件的不同chunk集合</li>
<li>节点定期查询每个邻居所持有的chunk列表</li>
<li>节点发送请求，请求获取礐石的chunk<ul>
<li>稀缺优先，例如某些个缺失的chunk只有3个节点有，另一些缺失的有100个节点能提供，优先获取少的节点的那些chunk</li>
</ul>
</li>
</ul>
<p><strong>发送chunk</strong>：tit-for-tat</p>
<ul>
<li>某个节点向n个邻居发送chunk：正在向其发送chunk，速率最快的n个（每10秒重新评估）</li>
<li>每30秒随机选择一个其它节点，向其发送chunk，可能成为新的top n</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/07/pINc2Y4X8KdT5EL.png" alt="image-20220507234338662"></p>
<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>P2P系统的索引：信息到节点位置（IP地址+端口号）的映射</p>
<ul>
<li>文件共享：利用索引动态跟踪节点所共享的文件的位置，节点需要告诉索引它拥有哪些文件，节点搜索索引，从而知道能够得到哪些文件</li>
<li>即时消息：索引负责将用户名映射到位置，当用户开启IM应用时，需要通知索引它的位置；节点检索索引，确定用户的IP地址</li>
</ul>
<h3 id="集中式索引"><a href="#集中式索引" class="headerlink" title="集中式索引"></a>集中式索引</h3><p><img src="https://s2.loli.net/2022/05/08/OiBtDYxLzoarRc1.png" alt="image-20220508091301203"></p>
<p>有一个中央目录服务器，任何节点加入时需要通知中央服务器自己的IP地址和内容；向中央服务器查找，找到地址后点对点传输</p>
<blockquote>
<p>内容定位是高度集中式的，存在单点失效问题、性能瓶颈、版权问题</p>
</blockquote>
<h3 id="洪泛式查询"><a href="#洪泛式查询" class="headerlink" title="洪泛式查询"></a>洪泛式查询</h3><p>每个节点对它共享的文件进行索引，且只对它共享的文件进行索引</p>
<p><strong>覆盖网络</strong>：节点X与Y之间如果有TCP连接，那么构成一个边，所有活动节点和边构成覆盖网络（节点一般邻居数少于10个）</p>
<p><img src="https://s2.loli.net/2022/05/08/YaATBUNxMmbrQWt.png" alt="image-20220508092033375"></p>
<p>被查询的节点继续向它的邻居发送查询消息，如果查询命中则利用反向路径返回查询节点。</p>
<h3 id="层次式覆盖网络"><a href="#层次式覆盖网络" class="headerlink" title="层次式覆盖网络"></a>层次式覆盖网络</h3><p>介于集中式和洪泛式之间的查询方法</p>
<p>每个节点或是一个超级节点，或者被分配一个超级节点，节点和超级节点之间维持TCP，某些超级节点之间维持TCP连接，超级节点负责跟踪子节点的内容</p>
<p><img src="https://s2.loli.net/2022/05/08/UsZEfMitHorJcR5.png" alt="image-20220508092451992"></p>
<blockquote>
<ul>
<li>例子：Skype</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/08/2q7vQVYotpUZz3T.png" alt="image-20220508092619353"></p>
</blockquote>
<h1 id="DHCP"><a href="#DHCP" class="headerlink" title="$DHCP$"></a>$DHCP$</h1><h2 id="如何获得-IP-地址"><a href="#如何获得-IP-地址" class="headerlink" title="如何获得$IP$地址"></a>如何获得$IP$地址</h2><p><strong>硬编码</strong></p>
<ul>
<li>通过静态配置完成</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/15/A8eGToaqFS1Q3Ps.png" alt="image-20220515161129813"></p>
<blockquote>
<p>默认网关：当这个子网的$IP$数据报要离开这个子网的时候要送到哪个接口进行转发</p>
</blockquote>
<p><strong>动态主机配置协议（$DHCP$）</strong></p>
<ul>
<li>从服务器动态获取$IP$地址、子网掩码、默认网关、$DNS$服务器名称与$IP$地址</li>
<li>“即插即用”</li>
<li>允许地址重用（主机租用地址，关机后还回地址，允许再分配给其它主机）</li>
<li>支持在用地址续租</li>
<li>支持移动用户加入网络</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/15/i2F7IUPdM3yxroX.png" alt="image-20220515161837191"></p>
<h2 id="工作过程"><a href="#工作过程" class="headerlink" title="工作过程"></a>工作过程</h2><p>交换报文：</p>
<ul>
<li>主机广播”$DHCP \space dicover$”（发现报文）</li>
<li>$DHCP$服务器利用“$DHCP \space offer$”（提供报文）进行响应（广播）</li>
<li>$DHCP \space request$，广播，通告其它$DHCP$服务器本机正在从某一个$DHCP$服务器申请$IP$，其它服务器可以收回预分配的$IP$</li>
<li>主机请求$IP$地址：“$DHCP \space ack$”（确认报文）</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/15/YgbScNKiBdnvJ3k.png" alt="image-20220515163240173"></p>
<ul>
<li><p>请求报文封装到$UDP$数据包中</p>
</li>
<li><p>$IP$广播</p>
</li>
<li><p>链路层广播</p>
</li>
<li>$DHCP$服务器构造$ACK$报文</li>
</ul>
<p><img src="https://s2.loli.net/2022/05/15/6E5le4NbkqWVQRc.png" alt="image-20220515163557274"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">jianjian</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://mujian.work/2022/05/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%89/">https://mujian.work/2022/05/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://mujian.work" target="_blank">划水摸鱼</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%BD%91/">计网</a><a class="post-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/05/07/qf4e2z9YBmPhV3c.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/09/%E6%A8%A1%E5%9D%97%E5%8C%96%E4%B8%8E%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F/"><img class="prev-cover" src="https://s2.loli.net/2022/04/28/oNXFKJVnSEuB1fM.png#" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">（十四）模块化与信息隐藏</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/28/%E8%AF%A6%E7%BB%86%E8%AE%BE%E8%AE%A1/"><img class="next-cover" src="https://s2.loli.net/2022/04/28/oNXFKJVnSEuB1fM.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">（十三）详细设计</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/05/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E5%AE%89%E5%85%A8%EF%BC%89/" title="计算机网络（安全）"><img class="cover" src="https://s2.loli.net/2022/05/29/WNQG5knthEdrLzB.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-29</div><div class="title">计算机网络（安全）</div></div></a></div><div><a href="/2022/05/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%89/" title="计算机网络（运输层）"><img class="cover" src="https://s2.loli.net/2022/05/12/BOsxyZXEaImMlLf.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-10</div><div class="title">计算机网络（运输层）</div></div></a></div><div><a href="/2022/05/24/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%EF%BC%89/" title="计算机网络（数据链路层）"><img class="cover" src="https://s2.loli.net/2022/05/27/7cHZ2lxTQ9JOrDM.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-24</div><div class="title">计算机网络（数据链路层）</div></div></a></div><div><a href="/2022/04/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E6%A6%82%E8%BF%B0%EF%BC%89/" title="计算机网络(概述)"><img class="cover" src="https://s2.loli.net/2022/04/27/jbCIaKLHfQw7uWz.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-27</div><div class="title">计算机网络(概述)</div></div></a></div><div><a href="/2022/05/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%88%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%89/" title="计算机网络（网络层）"><img class="cover" src="https://s2.loli.net/2022/05/14/ql1w5dKJmnY3irH.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-14</div><div class="title">计算机网络（网络层）</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">网络应用的体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E6%9C%BA-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84%EF%BC%88C-S%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">客户机&#x2F;服务器结构（C&#x2F;S）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E5%AF%B9%E7%82%B9%E7%BB%93%E6%9E%84%EF%BC%88P2P%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">点对点结构（P2P）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E7%BB%93%E6%9E%84%EF%BC%88Hybird%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">混合结构（Hybird）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1"><span class="toc-number">2.</span> <span class="toc-text">网络应用进程通信</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B"><span class="toc-number">2.1.</span> <span class="toc-text">进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-number">2.2.</span> <span class="toc-text">套接字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AF%BB%E5%9D%80"><span class="toc-number">2.3.</span> <span class="toc-text">如何寻址</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E7%B3%BB%E7%BB%9FDNS"><span class="toc-number">3.</span> <span class="toc-text">域名解析系统DNS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">3.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">3.2.</span> <span class="toc-text">DNS域名服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS%E8%AE%B0%E5%BD%95%E5%92%8C%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.3.</span> <span class="toc-text">DNS记录和消息格式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95"><span class="toc-number">3.3.1.</span> <span class="toc-text">记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.3.2.</span> <span class="toc-text">消息格式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE%E6%A6%82%E8%BF%B0"><span class="toc-number">4.</span> <span class="toc-text">应用层协议概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">4.1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AE%B9"><span class="toc-number">4.1.1.</span> <span class="toc-text">内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E4%BC%A0%E8%BE%93%E5%B1%82%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%9C%80%E6%B1%82"><span class="toc-number">4.1.2.</span> <span class="toc-text">对传输层服务的需求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Internet%E6%8F%90%E4%BE%9B%E7%9A%84%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.1.2.1.</span> <span class="toc-text">Internet提供的传输服务</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%BC%A0%E9%80%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.</span> <span class="toc-text">文件传送协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#FTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.1.</span> <span class="toc-text">FTP协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TFTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.2.</span> <span class="toc-text">TFTP协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TELNET%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.3.</span> <span class="toc-text">TELNET协议</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">6.</span> <span class="toc-text">HTTP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E8%BF%9E%E6%8E%A5%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.1.</span> <span class="toc-text">HTTP连接的两种类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%8C%81%E4%B9%85%E6%80%A7%E8%BF%9E%E6%8E%A5%EF%BC%88Nonpersistent-HTTP%EF%BC%89"><span class="toc-number">6.1.1.</span> <span class="toc-text">非持久性连接（Nonpersistent HTTP）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E6%80%A7%E8%BF%9E%E6%8E%A5%EF%BC%88Persistent-HTTP%EF%BC%89"><span class="toc-number">6.1.2.</span> <span class="toc-text">持久性连接（Persistent HTTP）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E6%B6%88%E6%81%AF"><span class="toc-number">6.2.</span> <span class="toc-text">HTTP消息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF"><span class="toc-number">6.2.1.</span> <span class="toc-text">请求消息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E6%B6%88%E6%81%AF"><span class="toc-number">6.2.2.</span> <span class="toc-text">响应消息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie%E6%8A%80%E6%9C%AF"><span class="toc-number">6.3.</span> <span class="toc-text">Cookie技术</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web%E7%BC%93%E5%AD%98-%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8A%80%E6%9C%AF"><span class="toc-number">6.4.</span> <span class="toc-text">Web缓存&#x2F;代理服务器技术</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Email%E5%BA%94%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">Email应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">7.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SMTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">7.2.</span> <span class="toc-text">SMTP协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Email%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">7.3.</span> <span class="toc-text">Email消息格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%82%AE%E4%BB%B6%E8%AE%BF%E9%97%AE%EF%BC%88%E8%AF%BB%E5%8F%96%EF%BC%89%E5%8D%8F%E8%AE%AE"><span class="toc-number">7.4.</span> <span class="toc-text">邮件访问（读取）协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#POP3%E5%8D%8F%E8%AE%AE"><span class="toc-number">7.4.1.</span> <span class="toc-text">POP3协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IMAP%E5%8D%8F%E8%AE%AE"><span class="toc-number">7.4.2.</span> <span class="toc-text">IMAP协议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#P2P%E5%BA%94%E7%94%A8"><span class="toc-number">8.</span> <span class="toc-text">P2P应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BitTorrent"><span class="toc-number">8.1.</span> <span class="toc-text">BitTorrent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">8.2.</span> <span class="toc-text">索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E4%B8%AD%E5%BC%8F%E7%B4%A2%E5%BC%95"><span class="toc-number">8.2.1.</span> <span class="toc-text">集中式索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%AA%E6%B3%9B%E5%BC%8F%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.2.</span> <span class="toc-text">洪泛式查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E5%BC%8F%E8%A6%86%E7%9B%96%E7%BD%91%E7%BB%9C"><span class="toc-number">8.2.3.</span> <span class="toc-text">层次式覆盖网络</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DHCP"><span class="toc-number">9.</span> <span class="toc-text">$DHCP$</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97-IP-%E5%9C%B0%E5%9D%80"><span class="toc-number">9.1.</span> <span class="toc-text">如何获得$IP$地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">9.2.</span> <span class="toc-text">工作过程</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By jianjian</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Oh, year!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>